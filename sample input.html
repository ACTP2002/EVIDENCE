<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analyst 360 - Fraud Simulator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=JetBrains+Mono&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #020617; color: #f8fafc; overflow: hidden; }
        .mono { font-family: 'JetBrains Mono', monospace; font-size: 11px; }
        .phone-frame { width: 300px; height: 580px; background: #fff; border-radius: 36px; border: 8px solid #1e293b; overflow: hidden; color: #1e293b; }
        .dashboard-container { height: 100vh; overflow-y: auto; }
        .json-viewer { display: none; background: #000; color: #10b981; padding: 10px; border-radius: 4px; margin-top: 8px; white-space: pre-wrap; border: 1px solid #065f46; }
        .static-card { background: #1e293b; border: 1px solid #334155; border-radius: 8px; }
    </style>
</head>
<body class="p-4">

    <div class="flex h-full gap-6">
        
        <!-- LEFT: CUSTOMER INTERFACE (The Data Generator) -->
        <div class="flex flex-col items-center shrink-0">
            <h2 class="mb-4 text-sm font-bold tracking-widest text-slate-500 uppercase">Customer App</h2>
            <div class="phone-frame shadow-2xl flex flex-col">
                <div class="bg-indigo-600 p-6 pt-10 text-white shrink-0">
                    <h1 id="app-title" class="text-xl font-bold">SecureBank</h1>
                </div>

                <div id="screen-login" class="p-6">
                    <label class="block text-xs font-bold mb-1 uppercase opacity-50">Select Identity</label>
                    <select id="user-id" class="w-full border p-2 rounded mb-4 bg-gray-50 text-sm">
                        <option value="U123">U123 (High Risk ATO Case)</option>
                        <option value="u_100">u_100 (PEP / Suspended)</option>
                        <option value="u_001">u_001 (New Account)</option>
                    </select>
                    
                    <div class="bg-slate-100 p-3 rounded mb-6 border border-slate-200">
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="checkbox" id="simulate-vpn">
                            <span class="text-xs text-slate-600 font-semibold">Connect via VPN (VN)</span>
                        </label>
                    </div>

                    <button onclick="handleLogin()" class="w-full bg-indigo-600 text-white py-3 rounded-xl font-bold active:scale-95 transition shadow-lg">Login</button>
                </div>

                <div id="screen-wallet" class="p-6 hidden">
                    <div class="bg-slate-100 p-4 rounded-2xl mb-6">
                        <span class="text-[10px] uppercase text-slate-400 font-bold tracking-tighter">Current Balance</span>
                        <div id="app-balance" class="text-2xl font-bold">$12,450.00</div>
                    </div>
                    <label class="block text-xs text-slate-400 mb-1">Transfer Amount</label>
                    <input type="number" id="txn-amount" value="1083.21" class="w-full border p-2 rounded mb-6 text-xl font-bold">
                    <button onclick="handleTransfer()" class="w-full bg-emerald-600 text-white py-3 rounded-xl font-bold shadow-lg active:scale-95 transition mb-4">Send Money</button>
                    <button onclick="location.reload()" class="w-full text-slate-400 text-xs uppercase tracking-widest font-bold">Logout</button>
                </div>
            </div>
        </div>

        <!-- RIGHT: ANALYST DASHBOARD (The Data Consumer) -->
        <div class="flex-1 dashboard-container">
            <div class="flex justify-between items-end mb-6">
                <div>
                    <h2 class="text-2xl font-bold text-white">Analyst Command Center</h2>
                    <p class="text-slate-400 text-sm">Real-time mapping of Static User Data vs Moving Event Streams</p>
                </div>
                <div class="text-right">
                    <span class="text-xs font-bold text-slate-500 uppercase block">Global Case ID</span>
                    <span id="case-id-display" class="text-blue-400 font-mono">--</span>
                </div>
            </div>

            <div class="grid grid-cols-12 gap-6">
                
                <!-- COLUMN 1: STATIC DATA (PROFILE & STATUS) -->
                <div class="col-span-5 space-y-6">
                    <h3 class="text-xs font-bold text-indigo-400 uppercase tracking-widest border-b border-indigo-900/50 pb-2">User Intelligence (Static)</h3>
                    
                    <!-- Profile Section -->
                    <div class="static-card p-4">
                        <div class="flex justify-between items-start mb-4">
                            <h4 class="text-sm font-bold text-slate-300">Account Profile</h4>
                            <button onclick="toggleJson('json-profile')" class="text-[10px] bg-slate-700 px-2 py-0.5 rounded text-slate-300">JSON</button>
                        </div>
                        <div id="profile-content" class="grid grid-cols-2 gap-y-3 text-xs">
                            <div class="text-slate-500">Status</div><div id="p-status" class="font-bold text-slate-300">--</div>
                            <div class="text-slate-500">KYC Level</div><div id="p-kyc" class="font-bold text-slate-300">--</div>
                            <div class="text-slate-500">Risk Tier</div><div id="p-risk" class="font-bold text-slate-300">--</div>
                            <div class="text-slate-500">PEP Flag</div><div id="p-pep" class="font-bold text-slate-300">--</div>
                        </div>
                        <div id="json-profile" class="json-viewer"></div>
                    </div>

                    <!-- Status Snapshot Section -->
                    <div class="static-card p-4 border-t-4 border-t-blue-500">
                        <div class="flex justify-between items-start mb-4">
                            <h4 class="text-sm font-bold text-slate-300">Activity Baseline (30D)</h4>
                            <button onclick="toggleJson('json-status')" class="text-[10px] bg-slate-700 px-2 py-0.5 rounded text-slate-300">JSON</button>
                        </div>
                        <div id="status-content" class="grid grid-cols-2 gap-y-3 text-xs">
                            <div class="text-slate-500">30D Volume Out</div><div id="s-vol" class="font-bold text-blue-400">--</div>
                            <div class="text-slate-500">Baseline IP</div><div id="s-ip" class="font-bold text-slate-300">--</div>
                            <div class="text-slate-500">Avg Login Hour</div><div id="s-hour" class="font-bold text-slate-300">--</div>
                        </div>
                        <div id="json-status" class="json-viewer"></div>
                    </div>
                </div>

                <!-- COLUMN 2: MOVING DATA (LIVE STREAM) -->
                <div class="col-span-7 space-y-6">
                    <h3 class="text-xs font-bold text-emerald-400 uppercase tracking-widest border-b border-emerald-900/50 pb-2">Event Stream (Moving)</h3>
                    <div id="event-log" class="space-y-3 overflow-y-auto max-h-[70vh] pr-2">
                        <div class="text-center py-20 text-slate-600 text-sm italic">
                            Waiting for app interaction to generate stream data...
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        // MOCKED STATIC DATA STORE
        const USER_DB = {
            "U123": {
                profile: { user_id: "U123", account_status: "active", kyc: { kyc_level: "full", age: 34 }, risk: { risk_tier: "medium", pep_flag: false } },
                status: { as_of: "2026-02-07", txn: { amount_out_30d: 4500 }, auth: { avg_login_hour: 2 }, network: { known_ip: "101.23.xx.xx" } }
            },
            "u_100": {
                profile: { user_id: "u_100", account_status: "suspended", kyc: { kyc_level: "tier_1", age: 65 }, risk: { risk_tier: "low", pep_flag: true, sanctions: "flagged" } },
                status: { as_of: "2026-02-07", txn: { amount_out_30d: 10000000 }, auth: { avg_login_hour: 14 }, network: { known_ip: "203.0.xx.xx" } }
            },
            "u_001": {
                profile: { user_id: "u_001", account_status: "active", kyc: { kyc_level: "basic", age: 22 }, risk: { risk_tier: "high", pep_flag: false } },
                status: { as_of: "2026-02-07", txn: { amount_out_30d: 150 }, auth: { avg_login_hour: 20 }, network: { known_ip: "dynamic" } }
            }
        };

        let currentUserID = null;
        let caseID = null;

        function handleLogin() {
            currentUserID = document.getElementById('user-id').value;
            const isVPN = document.getElementById('simulate-vpn').checked;
            caseID = "CASE-" + Date.now().toString().slice(-6);
            
            // UI Updates
            document.getElementById('case-id-display').innerText = caseID;
            document.getElementById('screen-login').classList.add('hidden');
            document.getElementById('screen-wallet').classList.remove('hidden');
            document.getElementById('app-balance').innerText = currentUserID === 'u_100' ? "$110,000.00" : "$12,450.00";

            // 1. Load Static Context
            loadUserContext(currentUserID);

            // 2. Log Moving Events (Auth & Network)
            const timestamp = new Date().toISOString();
            logMovingEvent('AUTH_ATTEMPT', {
                event_id: "evt_auth_" + Math.random().toString(36).substr(2, 5),
                event_time: timestamp,
                user_id: currentUserID,
                data: { success: true, mfa_used: true, vpn_detected: isVPN }
            }, 'border-blue-500');

            logMovingEvent('NETWORK_HEALTH', {
                event_id: "evt_net_" + Math.random().toString(36).substr(2, 5),
                event_time: timestamp,
                user_id: currentUserID,
                data: { ip: isVPN ? "14.191.xx.xx" : "101.23.xx.xx", vpn_suspected: isVPN }
            }, 'border-blue-500');
        }

        function loadUserContext(uid) {
            const context = USER_DB[uid];
            
            // Populate Dashboard Profile
            document.getElementById('p-status').innerText = context.profile.account_status.toUpperCase();
            document.getElementById('p-kyc').innerText = context.profile.kyc.kyc_level.toUpperCase();
            document.getElementById('p-risk').innerText = context.profile.risk.risk_tier.toUpperCase();
            document.getElementById('p-pep').innerText = context.profile.risk.pep_flag ? "YES (WATCHLIST)" : "NO";
            document.getElementById('p-status').className = context.profile.account_status === 'suspended' ? 'font-bold text-red-500' : 'font-bold text-emerald-400';
            
            // Populate Dashboard Status
            document.getElementById('s-vol').innerText = "$" + context.status.txn.amount_out_30d.toLocaleString();
            document.getElementById('s-ip').innerText = context.status.network.known_ip;
            document.getElementById('s-hour').innerText = context.status.auth.avg_login_hour + ":00 Local";

            // Set JSON view
            document.getElementById('json-profile').innerText = JSON.stringify(context.profile, null, 2);
            document.getElementById('json-status').innerText = JSON.stringify(context.status, null, 2);
        }

        function handleTransfer() {
            const amount = document.getElementById('txn-amount').value;
            const timestamp = new Date().toISOString();
            const isSuspended = USER_DB[currentUserID].profile.account_status === 'suspended';

            logMovingEvent('TRANSACTION', {
                event_id: "evt_txn_" + Math.random().toString(36).substr(2, 5),
                event_time: timestamp,
                user_id: currentUserID,
                data: { amount: parseFloat(amount), result: isSuspended ? 'blocked' : 'success', channel: 'mobile_app' }
            }, 'border-emerald-500');

            if (amount > 4000 || isSuspended) {
                logMovingEvent('AI_INVESTIGATION', {
                    case_id: caseID,
                    user_id: currentUserID,
                    findings: amount > 4000 ? "Unusual Spike" : "Activity on Suspended Account",
                    risk_score: isSuspended ? 99 : 72
                }, 'border-red-500 bg-red-950/20');
            }
        }

        function logMovingEvent(type, json, borderClass) {
            const log = document.getElementById('event-log');
            if (log.children[0]?.classList.contains('italic')) log.innerHTML = '';

            const id = "json-" + Math.random().toString(36).substr(2, 5);
            const card = document.createElement('div');
            card.className = `p-3 rounded bg-slate-800/50 border-l-4 ${borderClass} shadow-sm`;
            card.innerHTML = `
                <div class="flex justify-between items-center cursor-pointer" onclick="toggleJson('${id}')">
                    <span class="text-[10px] font-mono text-slate-500">${json.event_time ? json.event_time.slice(11, 19) : 'AI-GEN'}</span>
                    <span class="text-xs font-bold text-slate-200">${type}</span>
                    <span class="text-[9px] text-indigo-400 font-bold tracking-widest">DETAILS</span>
                </div>
                <div id="${id}" class="json-viewer mono text-[9px]">${JSON.stringify(json, null, 2)}</div>
            `;
            log.prepend(card);
        }

        function toggleJson(id) {
            const el = document.getElementById(id);
            el.style.display = el.style.display === 'block' ? 'none' : 'block';
        }
    </script>
</body>
</html>